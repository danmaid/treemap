(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("vue")):"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["treemap"]=t(require("vue")):e["treemap"]=t(e["Vue"])})("undefined"!==typeof self?self:this,(function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="fb15")}({"5c37":function(e,t,n){"use strict";var r=n("6767"),i=n.n(r);i.a},6767:function(e,t,n){},8875:function(e,t,n){var r,i,u;(function(n,o){i=[],r=o,u="function"===typeof r?r.apply(t,i):r,void 0===u||(e.exports=u)})("undefined"!==typeof self&&self,(function(){function e(){const t=Object.getOwnPropertyDescriptor(document,"currentScript");if(!t&&"currentScript"in document&&document.currentScript)return document.currentScript;if(t&&t.get!==e&&document.currentScript)return document.currentScript;try{throw new Error}catch(h){var n,r,i,u=/.*at [^(]*\((.*):(.+):(.+)\)$/gi,o=/@([^@]*):(\d+):(\d+)\s*$/gi,a=u.exec(h.stack)||o.exec(h.stack),c=a&&a[1]||!1,l=a&&a[2]||!1,f=document.location.href.replace(document.location.hash,""),d=document.getElementsByTagName("script");c===f&&(n=document.documentElement.outerHTML,r=new RegExp("(?:[^\\n]+?\\n){0,"+(l-2)+"}[^<]*<script>([\\d\\D]*?)<\\/script>[\\d\\D]*","i"),i=n.replace(r,"$1").trim());for(var s=0;s<d.length;s++){if("interactive"===d[s].readyState)return d[s];if(d[s].src===c)return d[s];if(c===f&&d[s].innerHTML&&d[s].innerHTML.trim()===i)return d[s]}return null}}return e}))},"8bbf":function(t,n){t.exports=e},fb15:function(e,t,n){"use strict";if(n.r(t),"undefined"!==typeof window){var r=window.document.currentScript,i=n("8875");r=i(),"currentScript"in document||Object.defineProperty(document,"currentScript",{get:i});var u=r&&r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);u&&(n.p=u[1])}var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("dm-treemap",{staticStyle:{width:"1024px",height:"768px"},attrs:{value:e.sample},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.value;return[n("div",[e._v(e._s(r.text))])]}}])})],1)},a=[],c=n("8bbf"),l=n.n(c),f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"dm-treemap",class:{selected:e.selected},style:Object.assign({},e.size,e.position,e.override),on:{click:e.toggle,transitionend:e.calc}},[n("div",{staticClass:"label"},[e._v(e._s(e.value.label))]),e._t("default",null,{value:e.value}),n("div",{ref:"child",staticStyle:{position:"relative",flex:"1 1 100%"}},[e.d3t?e._l(e.d3t.children,(function(t,r){return n("dm-treemap",{key:r,staticStyle:{position:"absolute"},attrs:{value:t.data,size:e.getSize(t),position:e.getPosition(t)},scopedSlots:e._u([e._l(e.$scopedSlots,(function(t,n){return{key:n,fn:function(t){return[e._t(n,null,null,t)]}}}))],null,!0)})})):e._e()],2)],2)},d=[],s=function(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)},h=function(e,t,n,r,i){var u,o=e.children,a=-1,c=o.length,l=e.value&&(r-t)/e.value;while(++a<c)u=o[a],u.y0=n,u.y1=i,u.x0=t,u.x1=t+=u.value*l},p=function(e,t,n,r,i){var u,o=e.children,a=-1,c=o.length,l=e.value&&(i-n)/e.value;while(++a<c)u=o[a],u.x0=t,u.x1=r,u.y0=n,u.y1=n+=u.value*l},v=(1+Math.sqrt(5))/2;function g(e,t,n,r,i,u){var o,a,c,l,f,d,s,v,g,y,m,b=[],x=t.children,_=0,w=0,S=x.length,j=t.value;while(_<S){c=i-n,l=u-r;do{f=x[w++].value}while(!f&&w<S);for(d=s=f,y=Math.max(l/c,c/l)/(j*e),m=f*f*y,g=Math.max(s/m,m/d);w<S;++w){if(f+=a=x[w].value,a<d&&(d=a),a>s&&(s=a),m=f*f*y,v=Math.max(s/m,m/d),v>g){f-=a;break}g=v}b.push(o={value:f,dice:c<l,children:x.slice(_,w)}),o.dice?h(o,n,r,i,j?r+=l*f/j:u):p(o,n,r,j?n+=c*f/j:i,u),j-=f,_=w}return b}var y=function e(t){function n(e,n,r,i,u){g(t,e,n,r,i,u)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(v);function m(e){if("function"!==typeof e)throw new Error;return e}function b(){return 0}var x=function(e){return function(){return e}},_=function(){var e=y,t=!1,n=1,r=1,i=[0],u=b,o=b,a=b,c=b,l=b;function f(e){return e.x0=e.y0=0,e.x1=n,e.y1=r,e.eachBefore(d),i=[0],t&&e.eachBefore(s),e}function d(t){var n=i[t.depth],r=t.x0+n,f=t.y0+n,d=t.x1-n,s=t.y1-n;d<r&&(r=d=(r+d)/2),s<f&&(f=s=(f+s)/2),t.x0=r,t.y0=f,t.x1=d,t.y1=s,t.children&&(n=i[t.depth+1]=u(t)/2,r+=l(t)-n,f+=o(t)-n,d-=a(t)-n,s-=c(t)-n,d<r&&(r=d=(r+d)/2),s<f&&(f=s=(f+s)/2),e(t,r,f,d,s))}return f.round=function(e){return arguments.length?(t=!!e,f):t},f.size=function(e){return arguments.length?(n=+e[0],r=+e[1],f):[n,r]},f.tile=function(t){return arguments.length?(e=m(t),f):e},f.padding=function(e){return arguments.length?f.paddingInner(e).paddingOuter(e):f.paddingInner()},f.paddingInner=function(e){return arguments.length?(u="function"===typeof e?e:x(+e),f):u},f.paddingOuter=function(e){return arguments.length?f.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):f.paddingTop()},f.paddingTop=function(e){return arguments.length?(o="function"===typeof e?e:x(+e),f):o},f.paddingRight=function(e){return arguments.length?(a="function"===typeof e?e:x(+e),f):a},f.paddingBottom=function(e){return arguments.length?(c="function"===typeof e?e:x(+e),f):c},f.paddingLeft=function(e){return arguments.length?(l="function"===typeof e?e:x(+e),f):l},f},w=function(e,t,n,r,i){var u,o,a=e.children,c=a.length,l=new Array(c+1);for(l[0]=o=u=0;u<c;++u)l[u+1]=o+=a[u].value;function f(e,t,n,r,i,u,o){if(e>=t-1){var c=a[e];return c.x0=r,c.y0=i,c.x1=u,void(c.y1=o)}var d=l[e],s=n/2+d,h=e+1,p=t-1;while(h<p){var v=h+p>>>1;l[v]<s?h=v+1:p=v}s-l[h-1]<l[h]-s&&e+1<h&&--h;var g=l[h]-d,y=n-g;if(u-r>o-i){var m=(r*y+u*g)/n;f(e,h,g,r,i,m,o),f(h,t,y,m,i,u,o)}else{var b=(i*y+o*g)/n;f(e,h,g,r,i,u,b),f(h,t,y,r,b,u,o)}}f(0,c,e.value,t,n,r,i)};function S(e){var t=0,n=e.children,r=n&&n.length;if(r)while(--r>=0)t+=n[r].value;else t=1;e.value=t}var j=function(){return this.eachAfter(S)},O=function(e){var t,n,r,i,u=this,o=[u];do{t=o.reverse(),o=[];while(u=t.pop())if(e(u),n=u.children,n)for(r=0,i=n.length;r<i;++r)o.push(n[r])}while(o.length);return this},M=function(e){var t,n,r=this,i=[r];while(r=i.pop())if(e(r),t=r.children,t)for(n=t.length-1;n>=0;--n)i.push(t[n]);return this},T=function(e){var t,n,r,i=this,u=[i],o=[];while(i=u.pop())if(o.push(i),t=i.children,t)for(n=0,r=t.length;n<r;++n)u.push(t[n]);while(i=o.pop())e(i);return this},$=function(e){return this.eachAfter((function(t){var n=+e(t.data)||0,r=t.children,i=r&&r.length;while(--i>=0)n+=r[i].value;t.value=n}))},E=function(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))},B=function(e){var t=this,n=C(t,e),r=[t];while(t!==n)t=t.parent,r.push(t);var i=r.length;while(e!==n)r.splice(i,0,e),e=e.parent;return r};function C(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),i=null;e=n.pop(),t=r.pop();while(e===t)i=e,e=n.pop(),t=r.pop();return i}var P=function(){var e=this,t=[e];while(e=e.parent)t.push(e);return t},k=function(){var e=[];return this.each((function(t){e.push(t)})),e},R=function(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e},z=function(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t};function A(e,t){var n,r,i,u,o,a=new I(e),c=+e.value&&(a.value=e.value),l=[a];null==t&&(t=L);while(n=l.pop())if(c&&(n.value=+n.data.value),(i=t(n.data))&&(o=i.length))for(n.children=new Array(o),u=o-1;u>=0;--u)l.push(r=n.children[u]=new I(i[u])),r.parent=n,r.depth=n.depth+1;return a.eachBefore(H)}function D(){return A(this).eachBefore(q)}function L(e){return e.children}function q(e){e.data=e.data.data}function H(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function I(e){this.data=e,this.depth=this.height=0,this.parent=null}function N(e,t){return _().tile(w).size([e,t])}I.prototype=A.prototype={constructor:I,count:j,each:O,eachAfter:T,eachBefore:M,sum:$,sort:E,path:B,ancestors:P,descendants:k,leaves:R,links:z,copy:D};var V=l.a.extend({name:"DmTreemap",props:{value:{type:Object,required:!0},size:{type:Object,default:function(){return{}}},position:{type:Object,default:function(){return{}}}},data:function(){return{d3t:void 0,selected:!1}},computed:{d3h:function(){var e=this.value;return A(e).sum((function(e){return e.children?0:1}))},override:function(){var e=this.selected;return e?{width:"100%",height:"100%",top:"0",left:"0"}:void 0}},watch:{value:function(){this.calc()}},mounted:function(){this.calc()},methods:{getPosition:function(e){var t=e.x0,n=e.y0;return{top:n+"px",left:t+"px"}},getSize:function(e){var t=e.x0,n=e.x1,r=e.y0,i=e.y1,u=n-t-16-1+"px",o=i-r-16-1+"px";return{width:u,height:o}},toggle:function(){this.selected=!this.selected},calc:function(){var e=this,t=e.d3h,n=e.$refs;if(n.child instanceof Element){var r=n.child.clientWidth,i=n.child.clientHeight;this.d3t=N(r,i)(t)}}}}),U=V;n("5c37");function X(e,t,n,r,i,u,o,a){var c,l="function"===typeof e?e.options:e;if(t&&(l.render=t,l.staticRenderFns=n,l._compiled=!0),r&&(l.functional=!0),u&&(l._scopeId="data-v-"+u),o?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),i&&i.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(o)},l._ssrRegister=c):i&&(c=a?function(){i.call(this,(l.functional?this.parent:this).$root.$options.shadowRoot)}:i),c)if(l.functional){l._injectStyles=c;var f=l.render;l.render=function(e,t){return c.call(t),f(e,t)}}else{var d=l.beforeCreate;l.beforeCreate=d?[].concat(d,c):[c]}return{exports:e,options:l}}var F=X(U,f,d,!1,null,"29dfb23e",null),W=F.exports,G=l.a.extend({name:"App",components:{DmTreemap:W},data:function(){return{sample:{children:[{label:"a",value:10},{label:"b",value:5,children:[{label:"b1",value:10},{label:"b2",value:5},{label:"b3",value:3,children:[{text:"b3-1 text",value:2},{text:"b3-2 text",value:2},{text:"b3-3 text",value:1}]},{label:"b4",value:2},{label:"b5",value:1}]},{label:"c",value:3,children:[{label:"c1",value:10},{label:"c2",value:5},{label:"c3",value:3}]},{label:"d",value:2},{label:"e",value:1},{label:"f",value:4}]}}}}),J=G,K=X(J,o,a,!1,null,null,null),Q=K.exports;t["default"]=Q}})["default"]}));
//# sourceMappingURL=treemap.umd.min.js.map